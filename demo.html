<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8" />
    <title>TP SOC ‚Äî Demo Services Web</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
        :root {
            --rest: #2563eb;
            --soap: #7c3aed;
            --graphql: #e11d48;
            --grpc: #0891b2;
            --bg: #0f172a;
            --surface: #1e293b;
            --card: #263348;
            --border: #334155;
            --text: #e2e8f0;
            --muted: #94a3b8;
            --success: #22c55e;
            --error: #ef4444;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            background: var(--bg);
            color: var(--text);
            font-family: 'Segoe UI', system-ui, sans-serif;
            min-height: 100vh;
        }

        /* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ */
        header {
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            border-bottom: 1px solid var(--border);
            padding: 1.5rem 2rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        header h1 {
            font-size: 1.5rem;
            font-weight: 700;
        }

        header span {
            font-size: 0.85rem;
            color: var(--muted);
        }

        .dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 6px;
        }

        /* ‚îÄ‚îÄ TABS ‚îÄ‚îÄ */
        nav {
            display: flex;
            background: var(--surface);
            border-bottom: 1px solid var(--border);
            overflow-x: auto;
        }

        .tab-btn {
            padding: 1rem 1.6rem;
            border: none;
            background: transparent;
            color: var(--muted);
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            border-bottom: 3px solid transparent;
            white-space: nowrap;
            transition: all .2s;
            display: flex;
            align-items: center;
            gap: .5rem;
        }

        .tab-btn:hover {
            color: var(--text);
        }

        .tab-btn.active {
            color: var(--text);
        }

        #tab-rest.active {
            border-color: var(--rest);
            color: #60a5fa;
        }

        #tab-soap.active {
            border-color: var(--soap);
            color: #a78bfa;
        }

        #tab-gql.active {
            border-color: var(--graphql);
            color: #fb7185;
        }

        #tab-grpc.active {
            border-color: var(--grpc);
            color: #38bdf8;
        }

        /* ‚îÄ‚îÄ CONTENT ‚îÄ‚îÄ */
        .tab-content {
            display: none;
            padding: 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        .tab-content.active {
            display: block;
        }

        /* ‚îÄ‚îÄ CARDS / PANELS ‚îÄ‚îÄ */
        .panel {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .panel h3 {
            font-size: 1rem;
            font-weight: 700;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: .5rem;
        }

        .badge {
            display: inline-block;
            padding: .15rem .55rem;
            border-radius: 6px;
            font-size: .7rem;
            font-weight: 700;
            letter-spacing: .04em;
        }

        .badge-get {
            background: #1d4ed8;
            color: #bfdbfe;
        }

        .badge-post {
            background: #166534;
            color: #bbf7d0;
        }

        .badge-put {
            background: #92400e;
            color: #fde68a;
        }

        .badge-patch {
            background: #7c2d12;
            color: #fed7aa;
        }

        .badge-delete {
            background: #7f1d1d;
            color: #fecaca;
        }

        .badge-soap {
            background: #4c1d95;
            color: #ddd6fe;
        }

        .badge-gql {
            background: #881337;
            color: #fecdd3;
        }

        .badge-grpc {
            background: #164e63;
            color: #bae6fd;
        }

        /* ‚îÄ‚îÄ BUTTONS ‚îÄ‚îÄ */
        .btn {
            border: none;
            border-radius: 8px;
            padding: .6rem 1.2rem;
            cursor: pointer;
            font-size: .85rem;
            font-weight: 600;
            transition: opacity .15s, transform .1s;
            display: inline-flex;
            align-items: center;
            gap: .4rem;
        }

        .btn:hover {
            opacity: .85;
            transform: translateY(-1px);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-rest {
            background: var(--rest);
            color: #fff;
        }

        .btn-soap {
            background: var(--soap);
            color: #fff;
        }

        .btn-gql {
            background: var(--graphql);
            color: #fff;
        }

        .btn-grpc {
            background: var(--grpc);
            color: #fff;
        }

        .btn-sm {
            padding: .35rem .8rem;
            font-size: .78rem;
        }

        /* ‚îÄ‚îÄ GRID ‚îÄ‚îÄ */
        .grid2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        @media(max-width:768px) {
            .grid2 {
                grid-template-columns: 1fr;
            }
        }

        /* ‚îÄ‚îÄ RESPONSE BOX ‚îÄ‚îÄ */
        .response-box {
            background: #0d1117;
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1rem;
            font-family: 'Cascadia Code', 'Fira Code', monospace;
            font-size: .78rem;
            line-height: 1.6;
            white-space: pre-wrap;
            word-break: break-all;
            max-height: 380px;
            overflow-y: auto;
            color: #c9d1d9;
            min-height: 60px;
        }

        .response-box .ok {
            color: var(--success);
        }

        .response-box .err {
            color: var(--error);
        }

        /* ‚îÄ‚îÄ STATUS BAR ‚îÄ‚îÄ */
        .status-bar {
            display: flex;
            align-items: center;
            gap: .5rem;
            margin-bottom: .5rem;
            font-size: .78rem;
            font-weight: 600;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .status-dot.ok {
            background: var(--success);
        }

        .status-dot.err {
            background: var(--error);
        }

        .status-dot.idle {
            background: var(--muted);
        }

        /* ‚îÄ‚îÄ INPUT ROW ‚îÄ‚îÄ */
        .input-row {
            display: flex;
            gap: .5rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
            align-items: center;
        }

        input[type=text],
        input[type=number],
        textarea,
        select {
            background: var(--card);
            border: 1px solid var(--border);
            color: var(--text);
            border-radius: 8px;
            padding: .55rem .8rem;
            font-size: .85rem;
            font-family: inherit;
            outline: none;
            transition: border-color .2s;
        }

        input:focus,
        textarea:focus,
        select:focus {
            border-color: #60a5fa;
        }

        textarea {
            resize: vertical;
            font-family: 'Cascadia Code', monospace;
            font-size: .8rem;
            color: #e2e8f0 !important;
        }

        label {
            font-size: .82rem;
            color: var(--muted);
            font-weight: 600;
        }

        /* ‚îÄ‚îÄ SECTION TITLE ‚îÄ‚îÄ */
        .section-title {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: .6rem;
        }

        /* ‚îÄ‚îÄ INFO BOX ‚îÄ‚îÄ */
        .info-box {
            background: var(--card);
            border-left: 3px solid;
            border-radius: 0 8px 8px 0;
            padding: .8rem 1rem;
            margin-bottom: 1rem;
            font-size: .85rem;
            line-height: 1.6;
        }

        .info-box.rest {
            border-color: var(--rest);
        }

        .info-box.soap {
            border-color: var(--soap);
        }

        .info-box.gql {
            border-color: var(--graphql);
        }

        .info-box.grpc {
            border-color: var(--grpc);
        }

        /* ‚îÄ‚îÄ XML / CODE ‚îÄ‚îÄ */
        .code-block {
            background: #0d1117;
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1rem;
            font-family: 'Cascadia Code', 'Fira Code', monospace;
            font-size: .77rem;
            line-height: 1.7;
            overflow-x: auto;
            color: #c9d1d9;
            white-space: pre;
        }

        .hl-tag {
            color: #7ee787;
        }

        .hl-attr {
            color: #79c0ff;
        }

        .hl-val {
            color: #ffab70;
        }

        .hl-str {
            color: #a5d6ff;
        }

        .hl-kw {
            color: #f97583;
        }

        .hl-cmt {
            color: #8b949e;
            font-style: italic;
        }

        .hl-type {
            color: #d2a8ff;
        }

        /* ‚îÄ‚îÄ FLOW DIAGRAM ‚îÄ‚îÄ */
        .flow {
            display: flex;
            align-items: center;
            gap: .5rem;
            flex-wrap: wrap;
            margin: 1rem 0;
            font-size: .82rem;
        }

        .flow-box {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: .4rem .8rem;
        }

        .flow-arrow {
            color: var(--muted);
            font-size: 1.1rem;
        }

        /* ‚îÄ‚îÄ SPINNER ‚îÄ‚îÄ */
        .spinner {
            display: inline-block;
            width: 14px;
            height: 14px;
            border: 2px solid #ffffff44;
            border-top-color: #fff;
            border-radius: 50%;
            animation: spin .6s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* ‚îÄ‚îÄ SCROLLBAR ‚îÄ‚îÄ */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 3px;
        }
    </style>
</head>

<body>

    <header>
        <div>
            <h1>üåê TP ‚Äî Architectures orient√©es services</h1>
            <span>REST ¬∑ SOAP/WSDL ¬∑ GraphQL ¬∑ gRPC</span>
        </div>
    </header>

    <nav>
        <button class="tab-btn active" id="tab-rest" onclick="switchTab('rest')">
            <span class="dot" style="background:#2563eb"></span> REST API
        </button>
        <button class="tab-btn" id="tab-soap" onclick="switchTab('soap')">
            <span class="dot" style="background:#7c3aed"></span> SOAP / WSDL
        </button>
        <button class="tab-btn" id="tab-gql" onclick="switchTab('gql')">
            <span class="dot" style="background:#e11d48"></span> GraphQL
        </button>
        <button class="tab-btn" id="tab-grpc" onclick="switchTab('grpc')">
            <span class="dot" style="background:#0891b2"></span> gRPC
        </button>
    </nav>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê REST ‚ïê‚ïê‚ïê -->
    <div class="tab-content active" id="content-rest">
        <div class="section-title">
            <span class="dot" style="background:var(--rest);width:14px;height:14px"></span>
            REST API ‚Äî Travel Planner
            <span style="font-size:.8rem;color:var(--muted);font-weight:400">Flask ¬∑ localhost:5000</span>
        </div>

        <div class="grid2">
            <!-- GET ALL -->
            <div class="panel">
                <h3><span class="badge badge-get">GET</span> /destinations</h3>
                <div class="input-row">
                    <label>Pays :</label><input type="text" id="rest-country" placeholder="France" style="width:100px">
                    <label>Prix max :</label><input type="number" id="rest-maxprice" placeholder="200"
                        style="width:80px">
                    <button class="btn btn-rest" onclick="restGetAll()">GET</button>
                </div>
                <div class="status-bar"><span class="status-dot idle" id="s-getall"></span><span
                        id="st-getall">Inactif</span></div>
                <div class="response-box" id="r-getall">En attente‚Ä¶</div>
            </div>

            <!-- GET ONE -->
            <div class="panel">
                <h3><span class="badge badge-get">GET</span> /destinations/:id</h3>
                <div class="input-row">
                    <label>ID :</label>
                    <select id="rest-getid" style="width:80px">
                        <option>1</option>
                        <option>2</option>
                        <option>3</option>
                    </select>
                    <button class="btn btn-rest" onclick="restGetOne()">GET</button>
                </div>
                <div class="status-bar"><span class="status-dot idle" id="s-getone"></span><span
                        id="st-getone">Inactif</span></div>
                <div class="response-box" id="r-getone">En attente‚Ä¶</div>
            </div>

            <!-- POST -->
            <div class="panel">
                <h3><span class="badge badge-post">POST</span> /destinations ‚Äî Cr√©er</h3>
                <div class="input-row">
                    <label>Nom :</label><input type="text" id="rest-pname" value="Dubai" style="width:110px">
                    <label>Pays :</label><input type="text" id="rest-pct" value="UAE" style="width:80px">
                    <label>Prix/j :</label><input type="number" id="rest-pprice" value="250" style="width:70px">
                </div>
                <div class="input-row">
                    <label>Activit√©s :</label><input type="text" id="rest-pact" value="Burj Khalifa, Desert Safari"
                        style="width:240px">
                    <button class="btn btn-rest" onclick="restPost()">POST</button>
                </div>
                <div class="status-bar"><span class="status-dot idle" id="s-post"></span><span
                        id="st-post">Inactif</span></div>
                <div class="response-box" id="r-post">En attente‚Ä¶</div>
            </div>

            <!-- PUT -->
            <div class="panel">
                <h3><span class="badge badge-put">PUT</span> /destinations/:id ‚Äî Mise √† jour compl√®te</h3>
                <div class="input-row">
                    <label>ID :</label>
                    <select id="rest-putid" style="width:70px">
                        <option>1</option>
                        <option>2</option>
                        <option>3</option>
                    </select>
                    <label>Nom :</label><input type="text" id="rest-putname" value="Paris Updated" style="width:130px">
                    <label>Pays :</label><input type="text" id="rest-putcountry" value="France" style="width:90px">
                </div>
                <div class="input-row">
                    <label>Prix/j :</label><input type="number" id="rest-putprice" value="999" style="width:80px">
                    <label>Activit√©s :</label><input type="text" id="rest-putactivities" value="Tour Eiffel, Versailles"
                        style="width:200px">
                    <button class="btn btn-rest" onclick="restPut()">PUT</button>
                </div>
                <div class="status-bar"><span class="status-dot idle" id="s-put"></span><span id="st-put">Inactif</span>
                </div>
                <div class="response-box" id="r-put">En attente‚Ä¶</div>
            </div>

            <!-- PATCH -->
            <div class="panel">
                <h3><span class="badge badge-patch">PATCH</span> /destinations/:id ‚Äî Partiel</h3>
                <div class="input-row">
                    <label>ID :</label>
                    <select id="rest-patchid" style="width:70px">
                        <option>1</option>
                        <option>2</option>
                        <option>3</option>
                    </select>
                    <label>Nouveau prix :</label><input type="number" id="rest-patchprice" value="120"
                        style="width:80px">
                    <button class="btn btn-rest" onclick="restPatch()">PATCH</button>
                </div>
                <div class="status-bar"><span class="status-dot idle" id="s-patch"></span><span
                        id="st-patch">Inactif</span></div>
                <div class="response-box" id="r-patch">En attente‚Ä¶</div>
            </div>

            <!-- DELETE -->
            <div class="panel">
                <h3><span class="badge badge-delete">DELETE</span> /destinations/:id</h3>
                <div class="input-row">
                    <label>ID :</label>
                    <select id="rest-delid" style="width:70px">
                        <option>1</option>
                        <option>2</option>
                        <option>3</option>
                    </select>
                    <button class="btn btn-rest" onclick="restDelete()">Supprimer</button>
                </div>
                <div class="status-bar"><span class="status-dot idle" id="s-del"></span><span id="st-del">Inactif</span>
                </div>
                <div class="response-box" id="r-del">En attente‚Ä¶</div>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SOAP ‚ïê‚ïê‚ïê -->
    <div class="tab-content" id="content-soap">
        <div class="section-title">
            <span class="dot" style="background:var(--soap);width:14px;height:14px"></span>
            SOAP / WSDL ‚Äî Banking Service
            <span style="font-size:.8rem;color:var(--muted);font-weight:400">Spyne ¬∑ localhost:8000</span>
        </div>

        <div class="info-box soap">
            Service bancaire expos√© via <strong>SOAP 1.1</strong> avec un contrat <strong>WSDL auto-g√©n√©r√©</strong>.
            Les types de donn√©es sont d√©finis comme des <strong>sch√©mas XSD</strong> (Customer, Account, Transaction).
            C√¥t√© client, la biblioth√®que <code>zeep</code> parse le WSDL et s√©rialise les enveloppes XML
            automatiquement.
        </div>

        <!-- Comment SPYNE g√©n√®re le WSDL -->
        <div style="margin-top: 1.5rem;">
            <h3 style="margin-bottom: 1rem; color: #a8dadc; font-size: 1rem;">üîß Comment fonctionne la g√©n√©ration WSDL ?</h3>
            
            <div class="grid2" style="margin-bottom: 1rem;">
                <div class="panel" style="padding: 1rem; border-left: 3px solid #7c3aed;">
                    <h4 style="font-size: 0.95rem; margin-bottom: 0.5rem; color: #e2e8f0;">
                        1Ô∏è‚É£ Mod√®les de Donn√©es (ComplexModel)
                    </h4>
                    <p style="font-size: 0.85rem; color: var(--muted); margin: 0;">
                        Les classes <code>Customer</code>, <code>Account</code>, et <code>Transaction</code> 
                        h√©ritent de <strong>ComplexModel</strong> de Spyne. Chaque propri√©t√© de classe devient 
                        un type XSD dans le WSDL g√©n√©r√©.
                    </p>
                    <div style="margin-top: 0.5rem; padding: 0.5rem; background: rgba(124, 58, 237, 0.1); border-radius: 4px; font-size: 0.75rem; color: #cbd5e1; font-family: monospace;">
                        class Customer(ComplexModel):<br>
                        &nbsp;&nbsp;customer_id = Unicode<br>
                        &nbsp;&nbsp;first_name = Unicode<br>
                        &nbsp;&nbsp;registration_date = DateTime
                    </div>
                </div>

                <div class="panel" style="padding: 1rem; border-left: 3px solid #7c3aed;">
                    <h4 style="font-size: 0.95rem; margin-bottom: 0.5rem; color: #e2e8f0;">
                        2Ô∏è‚É£ Op√©rations SOAP (@rpc)
                    </h4>
                    <p style="font-size: 0.85rem; color: var(--muted); margin: 0;">
                        Le d√©corateur <strong>@rpc</strong> expose les m√©thodes comme op√©rations SOAP dans le WSDL. 
                        Les param√®tres et le type de retour (<code>_returns</code>) d√©finissent automatiquement 
                        la signature WSDL.
                    </p>
                    <div style="margin-top: 0.5rem; padding: 0.5rem; background: rgba(124, 58, 237, 0.1); border-radius: 4px; font-size: 0.75rem; color: #cbd5e1; font-family: monospace;">
                        @rpc(Unicode, Float, _returns=Boolean)<br>
                        def transfer_money(ctx, account, amount):<br>
                        &nbsp;&nbsp;# Impl√©mentation
                    </div>
                </div>

                <div class="panel" style="padding: 1rem; border-left: 3px solid #7c3aed;">
                    <h4 style="font-size: 0.95rem; margin-bottom: 0.5rem; color: #e2e8f0;">
                        3Ô∏è‚É£ Configuration Application
                    </h4>
                    <p style="font-size: 0.85rem; color: var(--muted); margin: 0;">
                        <strong>Spyne</strong> cr√©e automatiquement l'application SOAP avec le protocole SOAP 1.1, 
                        le namespace cible, et g√©n√®re le WSDL en fonction de tous les mod√®les et @rpc d√©clar√©s.
                    </p>
                    <div style="margin-top: 0.5rem; padding: 0.5rem; background: rgba(124, 58, 237, 0.1); border-radius: 4px; font-size: 0.75rem; color: #cbd5e1; font-family: monospace;">
                        app = Application([BankingService],<br>
                        &nbsp;&nbsp;tns='http://banking.soap.example.com')<br>
                        # WSDL g√©n√©r√© automatiquement!
                    </div>
                </div>

                <div class="panel" style="padding: 1rem; border-left: 3px solid #7c3aed;">
                    <h4 style="font-size: 0.95rem; margin-bottom: 0.5rem; color: #e2e8f0;">
                        4Ô∏è‚É£ Acc√®s au WSDL
                    </h4>
                    <p style="font-size: 0.85rem; color: var(--muted); margin: 0;">
                        Le WSDL g√©n√©r√© peut √™tre consult√© √† l'adresse :
                    </p>
                    <div style="margin-top: 0.5rem; padding: 0.5rem; background: rgba(124, 58, 237, 0.1); border-radius: 4px; font-size: 0.75rem; color: #22c55e; font-family: monospace;">
                        <strong>http://localhost:8000/?wsdl</strong>
                    </div>
                    <p style="font-size: 0.8rem; color: var(--muted); margin-top: 0.5rem; margin-bottom: 0;">
                        Les clients SOAP (comme <code>zeep</code>) acc√®dent √† ce WSDL pour conna√Ætre les 
                        op√©rations et structures de donn√©es disponibles.
                    </p>
                </div>
            </div>
        </div>

        <div class="flow">
            <div class="flow-box">Client Python (zeep)</div>
            <span class="flow-arrow">‚Üí</span>
            <div class="flow-box">Enveloppe SOAP / XML</div>
            <span class="flow-arrow">‚Üí</span>
            <div class="flow-box">HTTP POST :8000</div>
            <span class="flow-arrow">‚Üí</span>
            <div class="flow-box">Spyne (parse WSDL)</div>
            <span class="flow-arrow">‚Üí</span>
            <div class="flow-box">R√©ponse SOAP / XML</div>
        </div>

        <div class="grid2">
            <div class="panel">
                <h3><span class="badge badge-soap">SOAP</span> Requ√™te : get_customer_info</h3>
                <p style="font-size:.75rem;color:var(--muted);margin-bottom:.6rem">
                    <strong>HTTP POST</strong> <code>http://localhost:8000/</code>
                </p>
                <div class="code-block">&lt;?xml version='1.0' encoding='utf-8'?&gt;
                    <span class="hl-tag">&lt;soap-env:Envelope</span>
                    <span class="hl-attr">xmlns:soap-env</span>=<span
                        class="hl-val">"http://schemas.xmlsoap.org/soap/envelope/"</span><span
                        class="hl-tag">&gt;</span>
                    <span class="hl-tag">&lt;soap-env:Body&gt;</span>
                    <span class="hl-tag">&lt;ns0:get_customer_info</span>
                    <span class="hl-attr">xmlns:ns0</span>=<span
                        class="hl-val">"http://banking.soap.example.com"</span><span class="hl-tag">&gt;</span>
                    <span class="hl-tag">&lt;ns0:customer_id&gt;</span><span class="hl-str">CUST001</span><span
                        class="hl-tag">&lt;/ns0:customer_id&gt;</span>
                    <span class="hl-tag">&lt;/ns0:get_customer_info&gt;</span>
                    <span class="hl-tag">&lt;/soap-env:Body&gt;</span>
                    <span class="hl-tag">&lt;/soap-env:Envelope&gt;</span>
                </div>
            </div>

            <div class="panel">
                <h3><span class="badge badge-soap">SOAP</span> R√©ponse : get_customer_infoResponse</h3>
                <p style="font-size:.75rem;color:var(--muted);margin-bottom:.6rem">
                    <strong>HTTP Response</strong> <code>http://localhost:8000/</code> <span style="color:#22c55e;font-weight:600">(status: 200)</span>
                </p>
                
                <div class="code-block">&lt;?xml version='1.0' encoding='UTF-8'?&gt;
                    <span class="hl-tag">&lt;soap11env:Envelope</span>
                    <span class="hl-attr">xmlns:soap11env</span>=<span
                        class="hl-val">"http://schemas.xmlsoap.org/soap/envelope/"</span>
                    <span class="hl-attr">xmlns:tns</span>=<span
                        class="hl-val">"http://banking.soap.example.com"</span><span class="hl-tag">&gt;</span>
                    <span class="hl-tag">&lt;soap11env:Body&gt;</span>
                    <span class="hl-tag">&lt;tns:get_customer_infoResponse&gt;</span>
                    <span class="hl-tag">&lt;tns:get_customer_infoResult&gt;</span>
                    <span class="hl-tag">&lt;tns:customer_id&gt;</span><span class="hl-str">CUST001</span><span
                        class="hl-tag">&lt;/tns:customer_id&gt;</span>
                    <span class="hl-tag">&lt;tns:first_name&gt;</span><span class="hl-str">Cyrine</span><span
                        class="hl-tag">&lt;/tns:first_name&gt;</span>
                    <span class="hl-tag">&lt;tns:last_name&gt;</span><span class="hl-str">Zribi</span><span
                        class="hl-tag">&lt;/tns:last_name&gt;</span>
                    <span class="hl-tag">&lt;tns:email&gt;</span><span
                        class="hl-str">cyrine.zribi@telecom-sudparis.eu</span><span
                        class="hl-tag">&lt;/tns:email&gt;</span>
                    <span class="hl-tag">&lt;tns:phone&gt;</span><span class="hl-str">+33 6 12 34 56 78</span><span
                        class="hl-tag">&lt;/tns:phone&gt;</span>
                    <span class="hl-tag">&lt;tns:registration_date&gt;</span><span
                        class="hl-str">2024-01-15T00:00:00</span><span
                        class="hl-tag">&lt;/tns:registration_date&gt;</span>
                    <span class="hl-tag">&lt;/tns:get_customer_infoResult&gt;</span>
                    <span class="hl-tag">&lt;/tns:get_customer_infoResponse&gt;</span>
                    <span class="hl-tag">&lt;/soap11env:Body&gt;</span>
                    <span class="hl-tag">&lt;/soap11env:Envelope&gt;</span>
                </div>
            </div>


            <div class="panel" style="grid-column: 1 / -1">
                <h3><span class="badge badge-soap">WSDL</span> Structure du WSDL auto-g√©n√©r√© ‚Äî <code style="font-size:.8rem;color:var(--muted)">GET http://localhost:8000/?wsdl</code></h3>
                <p style="font-size:.8rem;color:var(--muted);margin-bottom:1rem">Le WSDL est divis√© en 5 sections. Voici un exemple de chacune :</p>

                <div style="display:grid;grid-template-columns:1fr 1fr;gap:1rem">

                    <div>
                        <p style="font-size:.78rem;font-weight:700;color:#a78bfa;margin-bottom:.4rem">‚ë† &lt;wsdl:types&gt; ‚Äî Sch√©mas XSD des donn√©es</p>
                        <div class="code-block" style="font-size:.72rem"><span class="hl-tag">&lt;xs:complexType</span> <span class="hl-attr">name</span>=<span class="hl-val">"Customer"</span><span class="hl-tag">&gt;</span>
  <span class="hl-tag">&lt;xs:sequence&gt;</span>
    <span class="hl-tag">&lt;xs:element</span> <span class="hl-attr">name</span>=<span class="hl-val">"customer_id"</span>  <span class="hl-attr">type</span>=<span class="hl-val">"xs:string"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;xs:element</span> <span class="hl-attr">name</span>=<span class="hl-val">"first_name"</span>   <span class="hl-attr">type</span>=<span class="hl-val">"xs:string"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;xs:element</span> <span class="hl-attr">name</span>=<span class="hl-val">"last_name"</span>    <span class="hl-attr">type</span>=<span class="hl-val">"xs:string"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;xs:element</span> <span class="hl-attr">name</span>=<span class="hl-val">"email"</span>        <span class="hl-attr">type</span>=<span class="hl-val">"xs:string"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;xs:element</span> <span class="hl-attr">name</span>=<span class="hl-val">"phone"</span>        <span class="hl-attr">type</span>=<span class="hl-val">"xs:string"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;xs:element</span> <span class="hl-attr">name</span>=<span class="hl-val">"registration_date"</span> <span class="hl-attr">type</span>=<span class="hl-val">"xs:dateTime"</span><span class="hl-tag">/&gt;</span>
  <span class="hl-tag">&lt;/xs:sequence&gt;</span>
<span class="hl-tag">&lt;/xs:complexType&gt;</span></div>
                    </div>

                    <div>
                        <p style="font-size:.78rem;font-weight:700;color:#a78bfa;margin-bottom:.4rem">‚ë° &lt;wsdl:message&gt; ‚Äî Enveloppes d'entr√©e/sortie</p>
                        <div class="code-block" style="font-size:.72rem"><span class="hl-tag">&lt;wsdl:message</span> <span class="hl-attr">name</span>=<span class="hl-val">"get_customer_info"</span><span class="hl-tag">&gt;</span>
  <span class="hl-tag">&lt;wsdl:part</span> <span class="hl-attr">name</span>=<span class="hl-val">"get_customer_info"</span>
    <span class="hl-attr">element</span>=<span class="hl-val">"tns:get_customer_info"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/wsdl:message&gt;</span>

<span class="hl-tag">&lt;wsdl:message</span> <span class="hl-attr">name</span>=<span class="hl-val">"get_customer_infoResponse"</span><span class="hl-tag">&gt;</span>
  <span class="hl-tag">&lt;wsdl:part</span> <span class="hl-attr">name</span>=<span class="hl-val">"get_customer_infoResponse"</span>
    <span class="hl-attr">element</span>=<span class="hl-val">"tns:get_customer_infoResponse"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/wsdl:message&gt;</span>
</div>
                    </div>

                    <div>
                        <p style="font-size:.78rem;font-weight:700;color:#a78bfa;margin-bottom:.4rem">‚ë¢ &lt;wsdl:portType&gt; ‚Äî Interface abstraite (op√©rations)</p>
                        <div class="code-block" style="font-size:.72rem"><span class="hl-tag">&lt;wsdl:portType</span> <span class="hl-attr">name</span>=<span class="hl-val">"Application"</span><span class="hl-tag">&gt;</span>
  <span class="hl-tag">&lt;wsdl:operation</span> <span class="hl-attr">name</span>=<span class="hl-val">"get_customer_info"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;wsdl:input</span>  <span class="hl-attr">message</span>=<span class="hl-val">"tns:get_customer_info"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;wsdl:output</span> <span class="hl-attr">message</span>=<span class="hl-val">"tns:get_customer_infoResponse"</span><span class="hl-tag">/&gt;</span>
  <span class="hl-tag">&lt;/wsdl:operation&gt;</span>
<span class="hl-tag">&lt;/wsdl:portType&gt;</span></div>
                    </div>

                    <div>
                        <p style="font-size:.78rem;font-weight:700;color:#a78bfa;margin-bottom:.4rem">‚ë£ &lt;wsdl:binding&gt; ‚Äî Liaison concr√®te SOAP 1.1</p>
                        <div class="code-block" style="font-size:.72rem"><span class="hl-tag">&lt;wsdl:binding</span> <span class="hl-attr">name</span>=<span class="hl-val">"Application"</span> <span class="hl-attr">type</span>=<span class="hl-val">"tns:Application"</span><span class="hl-tag">&gt;</span>
  <span class="hl-tag">&lt;wsdlsoap11:binding</span> <span class="hl-attr">style</span>=<span class="hl-val">"document"</span>
    <span class="hl-attr">transport</span>=<span class="hl-val">"http://schemas.xmlsoap.org/soap/http"</span><span class="hl-tag">/&gt;</span>
  <span class="hl-tag">&lt;wsdl:operation</span> <span class="hl-attr">name</span>=<span class="hl-val">"get_customer_info"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;wsdlsoap11:operation</span> <span class="hl-attr">soapAction</span>=<span class="hl-val">"get_customer_info"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;wsdl:input</span><span class="hl-tag">&gt;</span><span class="hl-tag">&lt;wsdlsoap11:body</span> <span class="hl-attr">use</span>=<span class="hl-val">"literal"</span><span class="hl-tag">/&gt;</span><span class="hl-tag">&lt;/wsdl:input&gt;</span>
    <span class="hl-tag">&lt;wsdl:output</span><span class="hl-tag">&gt;</span><span class="hl-tag">&lt;wsdlsoap11:body</span> <span class="hl-attr">use</span>=<span class="hl-val">"literal"</span><span class="hl-tag">/&gt;</span><span class="hl-tag">&lt;/wsdl:output&gt;</span>
  <span class="hl-tag">&lt;/wsdl:operation&gt;</span>
<span class="hl-tag">&lt;/wsdl:binding&gt;</span></div>
                    </div>

                </div>

                <div style="margin-top:1rem">
                    <p style="font-size:.78rem;font-weight:700;color:#a78bfa;margin-bottom:.4rem">‚ë§ &lt;wsdl:service&gt; ‚Äî Point d'acc√®s r√©seau</p>
                    <div class="code-block" style="font-size:.72rem"><span class="hl-tag">&lt;wsdl:service</span> <span class="hl-attr">name</span>=<span class="hl-val">"BankingService"</span><span class="hl-tag">&gt;</span>
  <span class="hl-tag">&lt;wsdl:port</span> <span class="hl-attr">name</span>=<span class="hl-val">"Application"</span> <span class="hl-attr">binding</span>=<span class="hl-val">"tns:Application"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;wsdlsoap11:address</span> <span class="hl-attr">location</span>=<span class="hl-val">"http://localhost:8000/"</span><span class="hl-tag">/&gt;</span>
  <span class="hl-tag">&lt;/wsdl:port&gt;</span>
<span class="hl-tag">&lt;/wsdl:service&gt;</span></div>
                </div>
            </div>
        </div>

        <div class="panel">
            <h3>üìã Op√©rations disponibles</h3>
            <table style="width:100%;border-collapse:collapse;font-size:.85rem">
                <thead>
                    <tr style="border-bottom:1px solid var(--border);color:var(--muted)">
                        <th style="text-align:left;padding:.5rem">Op√©ration</th>
                        <th style="text-align:left;padding:.5rem">Param√®tres</th>
                        <th style="text-align:left;padding:.5rem">Retour</th>
                    </tr>
                </thead>
                <tbody>
                    <tr style="border-bottom:1px solid var(--border)">
                        <td style="padding:.6rem"><code>get_customer_info</code></td>
                        <td style="padding:.6rem"><code>customer_id</code></td>
                        <td style="padding:.6rem"><code>Customer</code></td>
                    </tr>
                    <tr style="border-bottom:1px solid var (--border)">
                        <td style="padding:.6rem"><code>get_account_balance</code></td>
                        <td style="padding:.6rem"><code>account_number</code></td>
                        <td style="padding:.6rem"><code>Account</code></td>
                    </tr>
                    <tr style="border-bottom:1px solid var(--border)">
                        <td style="padding:.6rem"><code>transfer_money</code></td>
                        <td style="padding:.6rem"><code>from, amount, to, description</code></td>
                        <td style="padding:.6rem"><code>TransferResult</code></td>
                    </tr>
                    <tr>
                        <td style="padding:.6rem"><code>get_transaction_history</code></td>
                        <td style="padding:.6rem"><code>account_number, limit</code></td>
                        <td style="padding:.6rem"><code>Array(Transaction)</code></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê GRAPHQL ‚ïê‚ïê‚ïê -->
    <div class="tab-content" id="content-gql">
        <div class="section-title">
            <span class="dot" style="background:var(--graphql);width:14px;height:14px"></span>
            GraphQL ‚Äî Travel Planner
            <span style="font-size:.8rem;color:var(--muted);font-weight:400">Graphene ¬∑ localhost:5001</span>
        </div>

        <div class="info-box gql">
            Contrairement √† REST (un endpoint par ressource), GraphQL expose un <strong>unique endpoint</strong>
            <code>/graphql</code>. Le client choisit <strong>exactement</strong> les champs qu'il veut.
            Support des <strong>Queries</strong> (lecture) et des <strong>Mutations</strong> (√©criture).
        </div>

        <div class="grid2">
            <div class="panel">
                <h3><span class="badge badge-gql">QUERY</span> Sc√©narios du client.py (7 exemples)</h3>
                <div class="input-row" style="flex-wrap:wrap;gap:.5rem;margin-bottom:1rem">

                    <button class="btn btn-gql btn-sm"
                        onclick="gqlPreset(`query {\n  destinations {\n    id\n    name\n    country\n    pricePerDay\n    activities\n  }\n}`)">
                        1 ¬∑ Toutes les destinations
                    </button>

                    <button class="btn btn-gql btn-sm"
                        onclick="gqlPreset(`query {\n  destinations(country: &quot;France&quot;) {\n    id\n    name\n    country\n    pricePerDay\n  }\n}`)">
                        2 ¬∑ Filtrer par pays (France)
                    </button>

                    <button class="btn btn-gql btn-sm"
                        onclick="gqlPreset(`query {\n  destination(id: 1) {\n    name\n    activities\n  }\n}`)">
                        3 ¬∑ Champs minimaux (ID=1)
                    </button>

                    <button class="btn btn-gql btn-sm"
                        onclick="gqlPreset(`query {\n  destinations(maxPrice: 150) {\n    name\n    pricePerDay\n  }\n}`)">
                        4 ¬∑ Budget ‚â§ 150 ‚Ç¨/jour
                    </button>

                    <button class="btn btn-gql btn-sm"
                        onclick="gqlPreset(`mutation {\n  createDestination(input: {\n    name: &quot;Rome&quot;\n    country: &quot;Italy&quot;\n    pricePerDay: 140\n    activities: [&quot;Colosseum&quot;, &quot;Vatican&quot;, &quot;Trevi Fountain&quot;]\n  }) {\n    success\n    message\n    destination {\n      id\n      name\n      country\n    }\n  }\n}`)">
                        5 ¬∑ Mutation : cr√©er Rome
                    </button>

                    <button class="btn btn-gql btn-sm"
                        onclick="gqlPreset(`mutation {\n  updateDestination(id: 1, pricePerDay: 165) {\n    success\n    message\n    destination {\n      name\n      pricePerDay\n    }\n  }\n}`)">
                        6 ¬∑ Mutation : m√†j prix ID=1
                    </button>

                    <button class="btn btn-gql btn-sm"
                        onclick="gqlPreset(`mutation {\n  deleteDestination(id: 4) {\n    success\n    message\n  }\n}`)">
                        7 ¬∑ Mutation : supprimer ID=4
                    </button>

                </div>

                <label style="display:block;margin-bottom:.4rem">Requ√™te GraphQL :</label>
                <textarea id="gql-query" rows="10" style="width:100%;margin-bottom:.8rem">query {
  destinations {
    id
    name
    country
    pricePerDay
    activities
  }
}</textarea>
                <button class="btn btn-gql" onclick="gqlSend()">‚ñ∂ Ex√©cuter</button>
                <div class="status-bar" style="margin-top:.8rem">
                    <span class="status-dot idle" id="s-gql"></span><span id="st-gql">Inactif</span>
                </div>
            </div>

            <div class="panel">
                <h3>R√©ponse GraphQL</h3>
                <div class="response-box" style="max-height:420px" id="r-gql">En attente d'une requ√™te‚Ä¶</div>
                <p style="font-size:.75rem;color:var(--muted);margin-top:.6rem">
                    üí° Seuls les champs demand√©s sont retourn√©s ‚Äî c'est la <strong>s√©lection de champs</strong> GraphQL.
                </p>
            </div>
        </div>

        <!-- panneau subscription -->
        <div class="panel" style="border-color:#e11d48">
            <h3>
                <span class="badge badge-gql">SUBSCRIPTION</span>
                Simulation temps r√©el ‚Äî <code style="font-size:.8rem;color:var(--muted)">GET /graphql/subscribe (SSE)</code>
            </h3>

            <div class="info-box gql" style="margin-bottom:1rem">
                Une vraie subscription GraphQL utilise <strong>WebSocket</strong>. Ici on simule le m√™me comportement
                avec <strong>Server-Sent Events (SSE)</strong> : le serveur <em>pousse</em> un √©v√©nement √† chaque
                <code>createDestination</code>, <code>updateDestination</code> ou <code>deleteDestination</code>.
                <br><br>
                <strong>Comment tester :</strong> cliquez sur <em>S'abonner</em>, puis ex√©cutez n'importe quelle mutation ci-dessus ‚Üí les √©v√©nements apparaissent en temps r√©el ici ‚Üì
            </div>

            <!-- sch√©ma conceptuel -->
            <div style="background:#0d1117;border:1px solid var(--border);border-radius:8px;padding:1rem;margin-bottom:1rem;font-family:'Cascadia Code',monospace;font-size:.78rem;color:#c9d1d9;line-height:1.8">
                <span style="color:#8b949e"># Sch√©ma conceptuel de la subscription</span><br>
                <span style="color:#f97583">subscription</span> {<br>
                &nbsp;&nbsp;<span style="color:#79c0ff">destinationAdded</span> {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;id &nbsp;name &nbsp;country &nbsp;pricePerDay<br>
                &nbsp;&nbsp;}<br>
                &nbsp;&nbsp;<span style="color:#79c0ff">destinationUpdated</span> {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;id &nbsp;name &nbsp;pricePerDay<br>
                &nbsp;&nbsp;}<br>
                &nbsp;&nbsp;<span style="color:#79c0ff">destinationDeleted</span> {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;id &nbsp;name<br>
                &nbsp;&nbsp;}<br>
                }
            </div>

            <div class="input-row">
                <button class="btn btn-gql" id="btn-sub" onclick="gqlSubscribe()">üîî S'abonner</button>
                <button class="btn" style="background:#334155;color:#e2e8f0" onclick="gqlUnsubscribe()">‚úñ Se d√©sabonner</button>
                <span style="font-size:.8rem;color:var(--muted)" id="sub-counter"></span>
            </div>

            <div class="status-bar">
                <span class="status-dot idle" id="s-sub"></span>
                <span id="st-sub">Non connect√©</span>
            </div>

            <label style="display:block;margin-top:.8rem;margin-bottom:.4rem">√âv√©nements re√ßus (temps r√©el) :</label>
            <div class="response-box" style="max-height:300px;min-height:100px" id="r-sub">En attente de connexion‚Ä¶</div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê gRPC ‚ïê‚ïê‚ïê -->
    <div class="tab-content" id="content-grpc">
        <div class="section-title">
            <span class="dot" style="background:var(--grpc);width:14px;height:14px"></span>
            gRPC ‚Äî Sensor Service
            <span style="font-size:.8rem;color:var(--muted);font-weight:400">Protocol Buffers ¬∑ localhost:50051</span>
        </div>

        <div class="info-box grpc">
            gRPC utilise <strong>Protocol Buffers</strong> (Protobuf) comme format de s√©rialisation binaire
            et <strong>HTTP/2</strong> comme transport. Le fichier <code>sensor.proto</code> d√©finit le contrat ‚Äî
            les fichiers <code>sensor_pb2.py</code> et <code>sensor_pb2_grpc.py</code> sont
            <strong>auto-g√©n√©r√©s</strong> par <code>protoc</code>.
        </div>

        <div class="grid2">
            <!-- SERVEUR gRPC -->
            <div class="panel">
                <h3><span class="badge badge-grpc">SERVEUR</span> Lancer le serveur gRPC</h3>
                <p style="font-size:.82rem;color:var(--muted);margin-bottom:.8rem">
                    Le serveur gRPC √©coute sur le port <strong>50051</strong>. Re√ßoit un <code>sensor_id</code>, retourne une temp√©rature simul√©e de 22.5¬∞C.
                </p>
                <div class="input-row">
                    <button class="btn btn-grpc" onclick="grpcStartServer()">‚ñ∂ D√©marrer le serveur</button>
                </div>
                <div class="status-bar">
                    <span class="status-dot idle" id="s-grpc-server"></span>
                    <span id="st-grpc-server">Inactif</span>
                </div>
                <label style="display:block;margin-top:.8rem;margin-bottom:.4rem">Sortie du serveur :</label>
                <div class="response-box" style="max-height:280px;min-height:120px" id="r-grpc-server">En attente‚Ä¶</div>
            </div>

            <!-- CLIENT gRPC -->
            <div class="panel">
                <h3><span class="badge badge-grpc">CLIENT</span> Appeler le serveur gRPC</h3>
                <p style="font-size:.82rem;color:var(--muted);margin-bottom:.8rem">
                    Envoie une requ√™te <code>SensorRequest</code> au serveur et r√©cup√®re la temp√©rature.
                </p>
                <div class="input-row">
                    <label>Capteur ID :</label>
                    <input type="text" id="grpc-sensor-id" value="SN-001" style="width:140px">
                    <button class="btn btn-grpc" onclick="grpcCallClient()">‚ñ∂ Lancer le client</button>
                </div>
                <div class="status-bar">
                    <span class="status-dot idle" id="s-grpc-client"></span>
                    <span id="st-grpc-client">Inactif</span>
                </div>
                <label style="display:block;margin-top:.8rem;margin-bottom:.4rem">R√©sultat du client :</label>
                <div class="response-box" style="max-height:220px;min-height:100px" id="r-grpc-client">En attente‚Ä¶</div>
            </div>
        </div>

        <!-- PROTO -->
        <div class="panel">
            <h3><span class="badge badge-grpc">PROTO</span> Contrat ‚Äî sensor.proto</h3>
            <p style="font-size:.8rem;color:var(--muted);margin-bottom:.8rem">Source de v√©rit√© du service ‚Äî d√©finit les messages et le service RPC :</p>
            <div class="code-block">syntax = <span class="hl-val">"proto3"</span>;
package sensorservice;

                    <span class="hl-cmt">// Service expos√©</span>
                    service Sensor {
                    rpc <span class="hl-type">GetTemperature</span> (<span class="hl-type">SensorRequest</span>)
                    returns (<span class="hl-type">SensorResponse</span>);
                    }

                    <span class="hl-cmt">// Requ√™te : identifiant du capteur</span>
                    message <span class="hl-type">SensorRequest</span> {
                    string sensor_id = 1;
                    }

<span class="hl-cmt">// R√©ponse : temp√©rature + unit√©</span>
message <span class="hl-type">SensorResponse</span> {
  float  temperature = 1;
  string unit        = 2;
}</div>
            <p style="font-size:.75rem;color:var(--muted);margin-top:.8rem">
                Compil√© avec <code>protoc</code> ‚Üí g√©n√®re <code>sensor_pb2.py</code> + <code>sensor_pb2_grpc.py</code>
            </p>
        </div>

    </div>

    <script>
        const REST = 'http://localhost:5000';
        const GQL = 'http://localhost:5001/graphql';
        const BRIDGE = 'http://localhost:8083';

        function switchTab(name) {
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.getElementById('tab-' + name).classList.add('active');
            document.getElementById('content-' + name).classList.add('active');
        }

        /* ‚îÄ‚îÄ helpers ‚îÄ‚îÄ */
        function setStatus(id, ok, label) {
            const dot = document.getElementById('s-' + id);
            const st = document.getElementById('st-' + id);
            dot.className = 'status-dot ' + (ok === null ? 'idle' : ok ? 'ok' : 'err');
            st.textContent = label;
        }
        function setResponse(id, text, ok) {
            const box = document.getElementById('r-' + id);
            box.textContent = text;
            box.style.color = ok === false ? 'var(--error)' : ok === true ? 'var(--success)' : '#c9d1d9';
        }
        function fmt(obj) { return JSON.stringify(obj, null, 2); }

        async function call(method, url, body, statusId) {
            setStatus(statusId, null, 'Envoi‚Ä¶');
            try {
                const opts = { method, headers: { 'Content-Type': 'application/json' } };
                if (body) opts.body = JSON.stringify(body);
                const r = await fetch(url, opts);
                const ok = r.ok || r.status === 304;
                const text = r.status === 204 || r.status === 304
                    ? `HTTP ${r.status} ‚Äî Pas de contenu / Ressource en cache`
                    : fmt(await r.json());
                setStatus(statusId, ok, `HTTP ${r.status} ${r.statusText}`);
                setResponse(statusId, text, ok);
            } catch (e) {
                setStatus(statusId, false, 'Erreur r√©seau');
                setResponse(statusId, `‚ùå Impossible de joindre le serveur.\n‚Üí Lancez d'abord : python REST/app.py\n\n${e}`, false);
            }
        }

        /* ‚îÄ‚îÄ REST ‚îÄ‚îÄ */
        async function restGetAll() {
            const country = document.getElementById('rest-country').value;
            const max_price = document.getElementById('rest-maxprice').value;
            let url = REST + '/destinations';
            const params = [];
            if (country) params.push('country=' + country);
            if (max_price) params.push('max_price=' + max_price);
            if (params.length) url += '?' + params.join('&');
            await call('GET', url, null, 'getall');
        }
        async function restGetOne() { await call('GET', `${REST}/destinations/${document.getElementById('rest-getid').value}`, null, 'getone'); }
        async function restPost() {
            const activities = document.getElementById('rest-pact').value.split(',').map(s => s.trim());
            await call('POST', `${REST}/destinations`, {
                name: document.getElementById('rest-pname').value,
                country: document.getElementById('rest-pct').value,
                price_per_day: +document.getElementById('rest-pprice').value,
                activities
            }, 'post');
        }
        async function restPut() {
            const id = document.getElementById('rest-putid').value;
            const activities = document.getElementById('rest-putactivities').value.split(',').map(s => s.trim()).filter(Boolean);
            await call('PUT', `${REST}/destinations/${id}`, {
                name: document.getElementById('rest-putname').value,
                country: document.getElementById('rest-putcountry').value,
                price_per_day: +document.getElementById('rest-putprice').value,
                activities
            }, 'put');
        }
        async function restPatch() {
            const id = document.getElementById('rest-patchid').value;
            await call('PATCH', `${REST}/destinations/${id}`, {
                price_per_day: +document.getElementById('rest-patchprice').value
            }, 'patch');
        }
        async function restDelete() {
            const id = document.getElementById('rest-delid').value;
            await call('DELETE', `${REST}/destinations/${id}`, null, 'del');
        }

        /* ‚îÄ‚îÄ GraphQL ‚îÄ‚îÄ */
        function gqlPreset(q) { document.getElementById('gql-query').value = q; }

        async function gqlSend() {
            const query = document.getElementById('gql-query').value.trim();
            setStatus('gql', null, 'Envoi‚Ä¶');
            try {
                const r = await fetch(GQL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ query })
                });
                const json = await r.json();
                const ok = !json.errors;
                setStatus('gql', ok, ok ? 'Succ√®s' : 'Erreur GraphQL');
                setResponse('gql', fmt(json), ok);
            } catch (e) {
                setStatus('gql', false, 'Erreur r√©seau');
                setResponse('gql', `‚ùå Impossible de joindre le serveur GraphQL.\n‚Üí Lancez d'abord : python graphQL/server.py\n\n${e}`, false);
            }
        }

        /* ‚îÄ‚îÄ GraphQL Subscription (SSE) ‚îÄ‚îÄ */
        let _sseSource = null;
        let _sseCount = 0;

        function gqlSubscribe() {
            if (_sseSource) return; // d√©j√† connect√©

            _sseSource = new EventSource('http://localhost:5001/graphql/subscribe');
            setStatus('sub', null, 'Connexion‚Ä¶');
            document.getElementById('r-sub').textContent = '';

            _sseSource.onopen = () => {
                setStatus('sub', true, 'Connect√© ‚Äî en √©coute‚Ä¶');
                document.getElementById('btn-sub').disabled = true;
            };

            _sseSource.onmessage = (e) => {
                const event = JSON.parse(e.data);

                if (event.type === 'heartbeat') return; // ignorer les pings

                _sseCount++;
                document.getElementById('sub-counter').textContent = `${_sseCount} √©v√©nement(s) re√ßu(s)`;

                const box = document.getElementById('r-sub');
                const now = new Date().toLocaleTimeString();

                // couleur selon le type d'√©v√©nement
                const colors = {
                    connected:           '#8b949e',
                    destinationAdded:    '#22c55e',
                    destinationUpdated:  '#f59e0b',
                    destinationDeleted:  '#ef4444',
                };
                const color = colors[event.type] || '#c9d1d9';

                const icons = {
                    connected:           'üîó',
                    destinationAdded:    '‚úÖ ADDED',
                    destinationUpdated:  '‚úèÔ∏è  UPDATED',
                    destinationDeleted:  'üóëÔ∏è  DELETED',
                };
                const label = icons[event.type] || event.type;

                const line = document.createElement('div');
                line.style.cssText = `color:${color};border-bottom:1px solid #1e293b;padding:.3rem 0;margin-bottom:.2rem`;
                line.textContent = `[${now}] ${label}  ${event.data ? JSON.stringify(event.data) : event.message || ''}`;
                box.prepend(line); // plus r√©cent en haut
            };

            _sseSource.onerror = () => {
                setStatus('sub', false, 'Connexion perdue');
                gqlUnsubscribe();
            };
        }

        function gqlUnsubscribe() {
            if (_sseSource) {
                _sseSource.close();
                _sseSource = null;
            }
            setStatus('sub', null, 'D√©connect√©');
            document.getElementById('btn-sub').disabled = false;
            document.getElementById('sub-counter').textContent = '';
            _sseCount = 0;
        }

        // ‚îÄ‚îÄ gRPC ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        async function grpcStartServer() {
            setStatus('grpc-server', null, 'D√©marrage du serveur...');
            try {
                const response = await fetch('http://localhost:5000/run-grpc-server', { 
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }
                });
                const json = await response.json();
                if (json.success) {
                    setStatus('grpc-server', true, 'Serveur en ligne');
                    setResponse('grpc-server', `‚úÖ Serveur gRPC lanc√© sur le port 50051\n\nSortie:\n${json.output}`, true);
                } else {
                    setStatus('grpc-server', false, 'Erreur');
                    setResponse('grpc-server', `‚ùå Erreur au d√©marrage:\n${json.error}`, false);
                }
            } catch (e) {
                setStatus('grpc-server', false, 'Erreur r√©seau');
                setResponse('grpc-server', `‚ùå Impossible de joindre le serveur REST.\n\nAssurez-vous que REST/app.py est lanc√©.\n\n${e}`, false);
            }
        }

        async function grpcCallClient() {
            const sensorId = document.getElementById('grpc-sensor-id').value.trim() || 'SN-001';
            setStatus('grpc-client', null, 'Lancement du client...');
            try {
                const response = await fetch('http://localhost:5000/run-grpc-client', { 
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ sensor_id: sensorId })
                });
                const json = await response.json();
                if (json.success) {
                    setStatus('grpc-client', true, 'Client ex√©cut√©');
                    setResponse('grpc-client', `‚úÖ R√©ponse du serveur gRPC:\n\n${json.output}`, true);
                } else {
                    setStatus('grpc-client', false, 'Erreur');
                    setResponse('grpc-client', `‚ùå Erreur lors de l'ex√©cution du client:\n${json.error}`, false);
                }
            } catch (e) {
                setStatus('grpc-client', false, 'Erreur r√©seau');
                setResponse('grpc-client', `‚ùå Impossible de joindre le serveur REST.\n\nAssurez-vous que:\n  1. python REST/app.py\n  2. python grpc/server.py\n\n${e}`, false);
            }
        }
    </script>
</body>

</html>